name: weeklyUpdate
on:
  push:
    branches: js/update-action
  schedule:
    - cron:  '0 9 * * 1'
  workflow_dispatch:

jobs:
  # e2e:
  #   runs-on: ubuntu-latest
  #   steps:
  #   - name: Check out code
  #     uses: actions/checkout@v2
  #   - name: Build docker image
  #     run: docker build -f "e2e.Dockerfile" -t lintier-e2e:latest "."
  #   - name: Run e2e tests
  #     run: docker run --rm -i lintier-e2e:latest
  update:
    runs-on: ubuntu-latest
    # needs: e2e
    steps:
    - uses: actions/checkout@v2
    - name: Cache Node Modules
      uses: actions/cache@v2
      with:
        path: ~/.npm
        key: ${{ runner.OS }}-node-${{ hashFiles('**/package-lock.json') }}
    - name: Install Node Modules
      run: npm ci
    - name: Update Pinned Versions
      run: npm run update-pinned-versions
  create-pr:
    runs-on: ubuntu-latest
    needs: [update]
    steps:
    - name: create-pr
      uses: peter-evans/create-pull-request@v7
      with:
        commit-message: update pinned versions
        title: Update Pinned Versions
        branch: update-pinned-versions
